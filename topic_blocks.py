topic_blocks = {
    "логарифмы": {
        "definition": "Логарифм числа b по основанию a — это показатель степени x, такой что a^x=b.",
        "youtube": [
            "https://youtu.be/UJ67zBGU_Zo",
            "https://youtu.be/AxMkmkXgRjQ"
        ],
        "summary": "Логарифмы используются для преобразования степеней.\nОсновные свойства:\n- log(a·b)=log(a)+log(b)\n- log(a/b)=log(a)-log(b)\n- log(a^k)=k·log(a)\nЛогарифмическое уравнение сводится к степенному виду.",
        "formulas": [
            "log_a(b) = x  ⇔  a^x = b",
            "log(a·b)=log(a)+log(b)",
            "log(a^k)=k·log(a)"
        ],
        "example": "log₂(32)=5, потому что 2⁵=32."
    },
    "тригонометрия": {
        "definition": "Тригонометрия изучает взаимосвязь между сторонами и углами треугольников.",
        "youtube": [
            "https://youtu.be/iNXYdBrAU5I",
            "https://youtu.be/IzPpgE1zbnk"
        ],
        "summary": "Основные функции: sin, cos, tg.\nСоотношения:\n- sin = противолежащий катет / гипотенуза\n- cos = прилежащий катет / гипотенуза\n- tg = sin/cos\nТождество: sin²x + cos²x = 1",
        "formulas": [
            "sin²x + cos²x = 1",
            "tgx = sinx / cosx"
        ],
        "example": "sin 30° = 1/2."
    },
    "интегралы": {
        "definition": "Интеграл — это операция, обратная дифференцированию; нахождение площади под кривой.",
        "youtube": [
            "https://youtu.be/K-jYwP9h2Xw"
        ],
        "summary": "Типы: неопределённые (первообразная) и определённые (числовое значение).\nМетоды интегрирования: прямой, замена переменной, интегрирование по частям.\nТабличные интегралы основных функций.",
        "formulas": [
            "∫xⁿ dx = xⁿ⁺¹ / (n+1) + C, n≠-1",
            "∫cosx dx = sinx + C"
        ],
        "example": "∫2x dx = x² + C."
    },
    "уравнения": {
        "definition": "Уравнение — математическое выражение, содержащее неизвестные переменные и знак равенства.",
        "youtube": [
            "https://youtu.be/z_1a0RzFlRg"
        ],
        "summary": "Цель: найти значения переменных, при которых равенство верно.\nТипы: линейные, квадратные, иррациональные, показательные.\nМетоды: перенос слагаемых, домножение, использование формул.",
        "formulas": [
            "Линейное: ax + b = 0",
            "Квадратное: ax² + bx + c = 0, D = b² - 4ac, x = (-b ± √D) / 2a"
        ],
        "example": "3x + 5 = 14  => 3x = 9  => x = 3."
    },
    "комбинаторика": {
        "definition": "Комбинаторика — раздел математики, изучающий дискретные объекты, множества (сочетания, перестановки, размещения).",
        "youtube": [
            "https://youtu.be/p8Fh-S-43W8"
        ],
        "summary": "Основные принципы: сложения, умножения.\nТипы: перестановки, размещения, сочетания.\nИспользование факториала.",
        "formulas": [
            "Pₙ = n!",
            "Cₙᵏ = n! / (k!(n-k)!)"
        ],
        "example": "Сколько способов выбрать 2 из 3 элементов: C₃² = 3."
    },
    "матрицы": {
        "definition": "Матрица — таблица чисел, над которой выполняются операции (сложение, умножение, определитель).",
        "youtube": [
            "https://youtu.be/z_1a0RzFlRg"
        ],
        "summary": "Основные операции:\n• сложение — по элементам\n• умножение — строки на столбцы\n• det — вычисление определителя\nИспользуются в системах линейных уравнений.",
        "formulas": [
            "A·B ≠ B·A (обычно)",
            "det([[a,b],[c,d]]) = ad − bc"
        ],
        "example": "det([[2,3],[1,4]]) = 2·4 − 3·1 = 5."
    },
    "вероятности": {
        "definition": "Вероятность — мера возможности наступления события.",
        "youtube": [
            "https://youtu.be/K8Sg5aI2V2I"
        ],
        "summary": "Формула: P(A) = (благоприятные исходы) / (все исходы).\nСобытия: независимые, зависимые, совместные, несовместные.\nТеоремы сложения и умножения вероятностей.",
        "formulas": [
            "P(A) = m/n",
            "P(A и B) = P(A) · P(B|A)"
        ],
        "example": "При броске кубика P(выпадения 3) = 1/6."
    },
    "неравенства": {
        "definition": "Неравенство — математическое выражение, где вместо знака равенства стоит знак неравенства (<, >, ≤, ≥).",
        "youtube": [
            "https://youtu.be/0y-Je8HoqtA"
        ],
        "summary": "Цель: найти интервалы значений переменных, при которых неравенство верно.\nТипы: линейные, квадратные, дробно-рациональные.\nМетоды: интервалов, графический, замена переменной.\nВажно учитывать ОДЗ и изменение знака при делении на отрицательное число.",
        "formulas": [
            "ax + b > 0",
            "ax² + bx + c < 0"
        ],
        "example": "x + 3 > 5  => x > 2."
    },
    "арифметика": {
        "definition": "Арифметика — раздел математики, изучающий числа и основные операции над ними.",
        "youtube": [
            "https://youtu.be/3z-z9uBw82s"
        ],
        "summary": "Основные операции: сложение, вычитание, умножение, деление.\nПорядок действий: скобки, степени, умножение/деление, сложение/вычитание.\nДействия с дробями, процентами, целыми числами.",
        "formulas": [
            "a + (b + c) = (a + b) + c",
            "a · (b + c) = a·b + a·c"
        ],
        "example": "(5 + 3) · 2 = 8 · 2 = 16."
    },
    "геометрия": {
        "definition": "Геометрия — раздел математики, изучающий пространственные формы и отношения.",
        "youtube": [
            "https://youtu.be/oG7j06XjMvI"
        ],
        "summary": "Основные понятия: точка, прямая, плоскость.\nФигуры: треугольники, четырёхугольники, круги.\nТеоремы: Пифагора, Фалеса, синусов, косинусов.",
        "formulas": [
            "Теорема Пифагора: a² + b² = c²",
            "Сумма углов треугольника = 180°"
        ],
        "example": "В прямоугольном треугольнике катеты 3 и 4, гипотенуза 5."
    },
    "площадь/объём": {
        "definition": "Площадь — площадь поверхности фигуры. Объём — пространство внутри тела.",
        "youtube": [
            "https://youtu.be/aUSzV6zG8AE"
        ],
        "summary": "Перед решением: определить фигуру.\nПлощади:\n• квадрат: S=a²\n• прямоугольник: S=a·b\n• круг: S=πr²\n\nОбъёмы:\n• куб: V=a³\n• цилиндр: V=πr²h",
        "formulas": [
            "S круга = πr²",
            "V цилиндра = πr²h"
        ],
        "example": "Если r=3 и h=10 → V=π·3²·10=90π."
    },
    "последовательности": {
        "definition": "Последовательность — упорядоченный набор чисел по правилу.",
        "youtube": [
            "https://youtu.be/Cq5E4_KHZn0"
        ],
        "summary": "Типы:\n• арифметическая: добавляем d\n• геометрическая: умножаем на q\n\nСуммы и формулы позволяют находить член без перебора.",
        "formulas": [
            "aₙ = a₁ + (n−1)d",
            "bₙ = b₁·q^(n−1)"
        ],
        "example": "Если a1=2,d=3 → a5=2+(5−1)·3=14."
    },
    "пределы": {
        "definition": "Предел функции — это значение, к которому функция приближается по мере того, как её аргумент приближается к некоторой точке.",
        "youtube": [
            "https://youtu.be/lJv4V3h_27o"
        ],
        "summary": "Используется для анализа поведения функции вблизи точек, где она может быть неопределена.\nОсновные правила вычисления пределов: сумма, произведение, частное.\nРаскрытие неопределённостей (0/0, ∞/∞) с помощью правил Лопиталя или эквивалентных бесконечно малых функций.",
        "formulas": [
            "lim (f(x) + g(x)) = lim f(x) + lim g(x)",
            "lim (f(x) / g(x)) = lim f(x) / lim g(x) (при условии)"
        ],
        "example": "lim (x→2) (x² - 4) / (x - 2) = lim (x→2) (x + 2) = 4."
    },
    "производные": {
        "definition": "Производная функции — это скорость изменения функции в данной точке.",
        "youtube": [
            "https://youtu.be/L8e5pW6yO5s"
        ],
        "summary": "Обозначается f'(x) или dy/dx.\nИспользуется для нахождения наклона касательной, скорости, ускорения.\nПравила дифференцирования: суммы, произведения, частного, сложной функции.",
        "formulas": [
            "(xⁿ)' = n·xⁿ⁻¹",
            "(sinx)' = cosx",
            "(eˣ)' = eˣ"
        ],
        "example": "Если f(x) = x², то f'(x) = 2x."
    },
    "проценты": {
        "definition": "Процент — сотая часть числа, используемая для выражения доли от целого.",
        "youtube": [
            "https://youtu.be/3z-z9uBw82s"
        ],
        "summary": "Обозначается знаком %. Используется для выражения доли от целого.\nРасчёт процента от числа, процентного изменения, нахождение числа по его проценту.\nПрименение в задачах на скидки, наценки, банковские вклады.",
        "formulas": [
            "Часть = Целое · Процент/100",
            "Процентное изменение = (Новое - Старое) / Старое · 100%"
        ],
        "example": "10% от 200 = 20."
    },
    "дроби": {
        "definition": "Дробь — число, представляющее часть целого или отношение двух чисел.",
        "youtube": [
            "https://youtu.be/YF_B5YnJ20s"
        ],
        "summary": "Основные понятия: числитель (верх), знаменатель (низ).\nОперации: сложение, вычитание, умножение, деление.\nПриведение к общему знаменателю.",
        "formulas": [
            "a/b + c/d = (ad + bc)/bd",
            "(a/b) · (c/d) = (a·c)/(b·d)"
        ],
        "example": "1/2 + 1/3 = 3/6 + 2/6 = 5/6."
    },
    "функции": {
        "definition": "Функция — правило, которое каждому элементу из одного множества (области определения) сопоставляет ровно один элемент из другого множества (области значений).",
        "youtube": [
            "https://youtu.be/vF0a4M1gXW0"
        ],
        "summary": "Основные характеристики: область определения, область значений, монотонность.\nТипы: линейные, квадратичные, показательные, логарифмические.\nГрафическое представление.",
        "formulas": [
            "y = kx + b (линейная)",
            "y = ax² + bx + c (квадратичная)"
        ],
        "example": "f(x) = 2x + 1. Если x=3, то f(3)=7."
    },
    "triangle_area_volume": {
        "definition": "Расчет площади или объема, связанного с треугольником.",
        "youtube": [
            "https://youtu.be/oG7j06XjMvI",
            "https://www.youtube.com/watch?v=FORMULA_TRIANGLE_AREA"
        ],
        "summary": "Для треугольника:\nПлощадь: S = (1/2) * основание * высота.\nПодумай о типе треугольника (прямоугольный, равносторонний и т.д.).",
        "formulas": [
            "S = (1/2)bh",
            "S = √(p(p-a)(p-b)(p-c)) (Формула Герона)"
        ],
        "example": "Площадь треугольника с основанием 10 см и высотой 6 см: S = (1/2) * 10 * 6 = 30 см².",
        "hint1": "Вспомни формулу для площади треугольника.",
        "hint2": "Площадь треугольника: S = (1/2) * основание * высота. S = (1/2)bh"
    },
    "square_area_volume": {
        "definition": "Расчет площади или периметра квадрата.",
        "youtube": [
            "https://youtu.be/oG7j06XjMvI",
            "https://www.youtube.com/watch?v=FORMULA_SQUARE_PERIMETER"
        ],
        "summary": "Для квадрата:\nПериметр: P = 4 * сторона.\nПлощадь: S = сторона².\nВсе стороны равны, все углы прямые.",
        "formulas": [
            "P = 4a",
            "S = a²"
        ],
        "example": "Периметр квадрата со стороной 7 см: P = 4 * 7 = 28 см.",
        "hint1": "Подумай, как найти периметр квадрата.",
        "hint2": "Периметр квадрата: P = 4 * сторона. P = 4a"
    },
    "rectangle_area_volume": {
        "definition": "Расчет площади или периметра прямоугольника.",
        "youtube": [
            "https://youtu.be/oG7j06XjMvI",
            "https://www.youtube.com/watch?v=FORMULA_RECTANGLE_AREA"
        ],
        "summary": "Для прямоугольника:\nПериметр: P = 2 * (длина + ширина).\nПлощадь: S = длина * ширина.\nПротивоположные стороны равны, все углы прямые.",
        "formulas": [
            "P = 2(a + b)",
            "S = a · b"
        ],
        "example": "Площадь прямоугольника со сторонами 4 и 5: S = 4 * 5 = 20.",
        "hint1": "Вспомни формулы для периметра и площади прямоугольника.",
        "hint2": "Периметр прямоугольника: P = 2(a + b). Площадь: S = a · b"
    },
    "circle_area_volume": {
        "definition": "Расчет площади или длины окружности (периметра) круга.",
        "youtube": [
            "https://youtu.be/aUSzV6zG8AE",
            "https://www.youtube.com/watch?v=FORMULA_CIRCLE_AREA"
        ],
        "summary": "Для круга:\nПлощадь: S = πr².\nДлина окружности: C = 2πr.\nЗапомни значение числа Пи (π ≈ 3.14).",
        "formulas": [
            "S = πr²",
            "C = 2πr"
        ],
        "example": "Площадь круга радиусом 5 см: S = π * 5² = 25π см².",
        "hint1": "Вспомни формулу для площади круга или длины окружности.",
        "hint2": "Площадь круга: S = πr². Длина окружности: C = 2πr."
    },
    "cube_area_volume": {
        "definition": "Расчет объема или площади поверхности куба.",
        "youtube": [
            "https://youtu.be/aUSzV6zG8AE",
            "https://www.youtube.com/watch?v=FORMULA_CUBE_VOLUME"
        ],
        "summary": "Для куба:\nОбъем: V = сторона³.\nПлощадь поверхности: S = 6 * сторона².\nВсе грани куба — это квадраты.",
        "formulas": [
            "V = a³",
            "S = 6a²"
        ],
        "example": "Объем куба с ребром 3 см: V = 3³ = 27 см³.",
        "hint1": "Вспомни формулы для объема и площади поверхности куба.",
        "hint2": "Объем куба: V = a³. Площадь поверхности: S = 6a²."
    },
    "cylinder_area_volume": {
        "definition": "Расчет объема или площади поверхности цилиндра.",
        "youtube": [
            "https://youtu.be/aUSzV6zG8AE",
            "https://www.youtube.com/watch?v=FORMULA_CYLINDER_VOLUME"
        ],
        "summary": "Для цилиндра:\nОбъем: V = πr²h.\nПлощадь боковой поверхности: S_бок = 2πrh.\nПлощадь полной поверхности: S_полн = 2πr(h + r).",
        "formulas": [
            "V = πr²h",
            "S_бок = 2πrh"
        ],
        "example": "Объем цилиндра с радиусом 2 и высотой 5: V = π * 2² * 5 = 20π.",
        "hint1": "Вспомни формулы для объема и площади поверхности цилиндра.",
        "hint2": "Объем цилиндра: V = πr²h. Площадь боковой поверхности: S_бок = 2πrh."
    }
}


topic_updates = {
    "логарифмы": {
        "summary": (
            "Логарифм числа b по основанию a — это показатель степени x: a^x = b.\n"
            "Перед преобразованиями всегда проверь ОДЗ:\n"
            "• основание a > 0, a ≠ 1\n"
            "• аргумент b > 0\n"
            "Типовой алгоритм:\n"
            "1) Запиши ОДЗ.\n"
            "2) Упростить выражение свойствами логарифмов.\n"
            "3) Если уравнение: приведи к виду log_a(f(x)) = log_a(g(x)) или к a^{…} = …\n"
            "4) Если неравенство: учитывай, что при 0 < a < 1 знак меняется.\n"
            "5) В конце подставь корни и отфильтруй по ОДЗ."
        ),
        "formulas": [
            "log_a(b) = x  ⇔  a^x = b",
            "ОДЗ: a>0, a≠1, b>0",
            "log_a(uv) = log_a(u) + log_a(v)",
            "log_a(u/v) = log_a(u) − log_a(v)",
            "log_a(u^k) = k·log_a(u)",
            "log_a(b) = log_c(b) / log_c(a)",
            "log_a(a) = 1",
            "log_a(1) = 0",
            "a^{log_a(b)} = b (b>0)",
            "log_a(a^x) = x (при x из ОДЗ)"
        ],
    },

    "тригонометрия": {
        "summary": (
            "Тригонометрия: sin, cos, tg и преобразования углов.\n"
            "Как решать типовые задачи:\n"
            "1) Если выражение сложное, сведи к sin/cos.\n"
            "2) Используй тождества (sin²+cos²=1) и формулы суммы/разности.\n"
            "3) Уравнения решай через базовый вид:\n"
            "   sin x = a, cos x = a, tg x = a.\n"
            "4) Обязательно добавляй периодичность (2π или π).\n"
            "5) При табличных значениях используй единичную окружность."
        ),
        "formulas": [
            "sin²x + cos²x = 1",
            "tgx = sinx / cosx",
            "ctgx = cosx / sinx",
            "sin(−x) = −sinx",
            "cos(−x) = cosx",
            "tg(−x) = −tgx",
            "sin(x±y) = sinx·cosy ± cosx·siny",
            "cos(x±y) = cosx·cosy ∓ sinx·siny",
            "sin(2x) = 2sinx·cosx",
            "cos(2x) = cos²x − sin²x = 1 − 2sin²x = 2cos²x − 1",
            "sin x = a ⇒ x = (−1)^k·arcsin(a) + kπ",
            "cos x = a ⇒ x = ±arccos(a) + 2kπ",
            "tg x = a ⇒ x = arctg(a) + kπ"
        ],
    },

    "интегралы": {
        "summary": (
            "Интеграл — обратная операция к производной.\n"
            "Типовой план решения:\n"
            "1) Попробуй табличную формулу.\n"
            "2) Если внутри сложная функция: замена переменной (u-substitution).\n"
            "3) Если произведение (x·e^x, x·sinx и т.п.): интегрирование по частям.\n"
            "4) Для определённого интеграла: после нахождения первообразной подставь пределы.\n"
            "5) Не забывай +C для неопределённого интеграла."
        ),
        "formulas": [
            "∫ f(x) dx = F(x) + C, где F'(x)=f(x)",
            "∫ x^n dx = x^(n+1)/(n+1) + C,  n≠−1",
            "∫ 1/x dx = ln|x| + C",
            "∫ e^x dx = e^x + C",
            "∫ a^x dx = a^x/ln(a) + C, a>0, a≠1",
            "∫ sinx dx = −cosx + C",
            "∫ cosx dx = sinx + C",
            "∫ 1/(1+x^2) dx = arctg(x) + C",
            "∫ 1/√(1−x^2) dx = arcsin(x) + C",
            "Замена: ∫ f(g(x))·g'(x) dx = ∫ f(u) du",
            "По частям: ∫ u dv = u·v − ∫ v du",
            "Определённый: ∫_a^b f(x) dx = F(b) − F(a)"
        ],
    },

    "уравнения": {
        "summary": (
            "Уравнение — равенство с неизвестной.\n"
            "Алгоритм:\n"
            "1) Упростить выражение, привести к стандартному виду.\n"
            "2) Выбрать метод: линейное, квадратное, разложение на множители, замена.\n"
            "3) Найти корни.\n"
            "4) Проверить подстановкой (особенно если были дроби, корни, логарифмы).\n"
            "5) Записать ответ."
        ),
        "formulas": [
            "Линейное: ax + b = 0 ⇒ x = −b/a (a≠0)",
            "Квадратное: ax² + bx + c = 0 (a≠0)",
            "D = b² − 4ac",
            "x = (−b ± √D)/(2a)",
            "Если D>0: 2 корня; D=0: 1 корень; D<0: нет действительных корней",
            "Разность квадратов: A² − B² = (A−B)(A+B)",
            "Квадрат суммы: (a+b)² = a² + 2ab + b²",
            "Квадрат разности: (a−b)² = a² − 2ab + b²",
            "|x| = a ⇒ x = ±a (a≥0)"
        ],
    },

    "комбинаторика": {
        "summary": (
            "Комбинаторика считает количество способов.\n"
            "Что выбрать:\n"
            "• Перестановки: когда важен порядок и берём все элементы.\n"
            "• Размещения: важен порядок, берём k из n.\n"
            "• Сочетания: порядок не важен, берём k из n.\n"
            "Часто применяются правила суммы и произведения."
        ),
        "formulas": [
            "Правило суммы: если варианты не пересекаются, то m+n",
            "Правило произведения: последовательные выборы, то m·n",
            "n! = 1·2·…·n, 0! = 1",
            "Перестановки: P_n = n!",
            "Размещения: A_n^k = n!/(n−k)!",
            "Сочетания: C_n^k = n!/(k!(n−k)!)",
            "C_n^k = C_n^{n−k}"
        ],
    },

    "матрицы": {
        "summary": (
            "Матрицы используются в системах уравнений и линейной алгебре.\n"
            "База:\n"
            "1) Сложение/вычитание — поэлементно.\n"
            "2) Умножение матриц: (AB)_{ij} = Σ a_{ik}b_{kj}.\n"
            "3) Определитель 2×2: ad−bc.\n"
            "4) Обратная матрица A^{-1} существует, если det(A)≠0."
        ),
        "formulas": [
            "Сложение: (A+B)_{ij} = a_{ij}+b_{ij}",
            "Умножение: (AB)_{ij} = Σ_{k} a_{ik}·b_{kj}",
            "det([[a,b],[c,d]]) = ad − bc",
            "A^{-1} существует ⇔ det(A) ≠ 0",
            "Для 2×2: [[a,b],[c,d]]^{-1} = (1/(ad−bc))·[[d,−b],[−c,a]]"
        ],
    },

    "вероятности": {
        "summary": (
            "Вероятность события A: P(A)=m/n.\n"
            "План решения:\n"
            "1) Определи пространство исходов (все варианты).\n"
            "2) Посчитай благоприятные исходы.\n"
            "3) Применяй формулы объединения/пересечения.\n"
            "Для независимых событий вероятность произведения равна произведению вероятностей."
        ),
        "formulas": [
            "P(A) = m/n",
            "P(Ā) = 1 − P(A)",
            "P(A ∪ B) = P(A) + P(B) − P(A ∩ B)",
            "Если A и B независимы: P(A ∩ B) = P(A)·P(B)",
            "Условная: P(A|B) = P(A ∩ B)/P(B), P(B)>0"
        ],
    },

    "неравенства": {
        "summary": (
            "Неравенства решаются поиском интервалов.\n"
            "Алгоритм (метод интервалов):\n"
            "1) Перенеси всё в одну сторону: f(x) > 0 или f(x) < 0.\n"
            "2) Найди нули числителя и точки, где знаменатель = 0.\n"
            "3) Разбей числовую прямую на интервалы.\n"
            "4) Определи знак f(x) на каждом интервале.\n"
            "5) Запиши ответ, учитывая строгий/нестрогий знак."
        ),
        "formulas": [
            "Если умножаем/делим на отрицательное число — знак меняется",
            "|x| < a ⇔ −a < x < a (a>0)",
            "|x| > a ⇔ x < −a или x > a (a>0)",
            "Квадратное: ax²+bx+c > 0 решается через корни и знак a"
        ],
    },

    "арифметика": {
        "summary": (
            "Арифметика: операции с числами и порядок действий.\n"
            "Правила:\n"
            "1) Порядок действий: скобки → степени → умножение/деление → сложение/вычитание.\n"
            "2) Деление на ноль запрещено.\n"
            "3) Работа с дробями: приводить к общему знаменателю при сложении/вычитании."
        ),
        "formulas": [
            "Порядок: ( ) → степени → ×/÷ → +/−",
            "a(b+c)=ab+ac",
            "a/b = a·(1/b), b≠0"
        ],
    },

    "геометрия": {
        "summary": (
            "Геометрия: фигуры, углы, теоремы.\n"
            "База:\n"
            "1) У треугольника сумма углов 180°.\n"
            "2) Для прямоугольного треугольника используем Пифагора.\n"
            "3) Площади считаем по формуле подходящей фигуры.\n"
            "Совет: делай аккуратный рисунок и подписывай данные."
        ),
        "formulas": [
            "Сумма углов треугольника: α+β+γ = 180°",
            "Пифагор: a² + b² = c²",
            "Площадь треугольника: S = 1/2·a·h_a",
            "Площадь параллелограмма: S = a·h_a",
            "Длина окружности: L = 2πr",
            "Площадь круга: S = πr²"
        ],
    },

    "площадь/объём": {
        "summary": (
            "Площади и объёмы: главное не перепутать формулы и единицы.\n"
            "Алгоритм:\n"
            "1) Определи фигуру/тело.\n"
            "2) Запиши формулу.\n"
            "3) Подставь значения.\n"
            "4) Единицы: площадь (см²), объём (см³)."
        ),
        "formulas": [
            "Квадрат: S = a², P = 4a",
            "Прямоугольник: S = ab, P = 2(a+b)",
            "Треугольник: S = 1/2·a·h",
            "Круг: S = πr², L = 2πr",
            "Куб: V = a³, S_пов = 6a²",
            "Призма: V = S_осн·h",
            "Цилиндр: V = πr²h, S_бок = 2πrh, S_полн = 2πr(h+r)",
            "Шар: V = 4/3·πr³, S = 4πr²"
        ],
    },

    "последовательности": {
        "summary": (
            "Последовательности и прогрессии.\n"
            "Типы:\n"
            "• Арифметическая: прибавляем одно и то же число d.\n"
            "• Геометрическая: умножаем на одно и то же число q.\n"
            "Часто нужно найти n-й член или сумму первых n членов."
        ),
        "formulas": [
            "Арифм.: a_n = a_1 + (n−1)d",
            "Арифм.: S_n = (a_1 + a_n)·n/2",
            "Геом.: b_n = b_1·q^(n−1)",
            "Геом.: S_n = b_1·(q^n − 1)/(q − 1), q≠1",
            "Если q=1: S_n = b_1·n"
        ],
    },

    "пределы": {
        "summary": (
            "Предел описывает поведение функции при x→a или x→∞.\n"
            "Как решать:\n"
            "1) Подстановка (если можно).\n"
            "2) Если неопределённость 0/0 или ∞/∞: вынеси общий множитель, сократи, используй замечательные пределы.\n"
            "3) Иногда помогает правило Лопиталя (если разрешено).\n"
            "4) Для тригонометрических пределов используй стандартные формулы."
        ),
        "formulas": [
            "lim_{x→a}(f(x)+g(x)) = lim f(x) + lim g(x)",
            "lim_{x→a}(f(x)·g(x)) = (lim f(x))·(lim g(x))",
            "lim_{x→a} f(x)/g(x) = (lim f(x))/(lim g(x)), если lim g(x)≠0",
            "Замечательный: lim_{x→0} sin x / x = 1",
            "Замечательный: lim_{x→0} (1−cos x)/x² = 1/2",
            "Замечательный: lim_{x→0} (1+x)^{1/x} = e"
        ],
    },

    "производные": {
        "summary": (
            "Производная показывает скорость изменения функции.\n"
            "Применения: касательная, экстремумы, исследование функции.\n"
            "Алгоритм экстремумов:\n"
            "1) Найди f'(x).\n"
            "2) Реши f'(x)=0.\n"
            "3) Проверь знак f'(x) или используй f''(x)."
        ),
        "formulas": [
            "(x^n)' = n·x^(n−1)",
            "(sinx)' = cosx",
            "(cosx)' = −sinx",
            "(tgx)' = 1/cos²x",
            "(e^x)' = e^x",
            "(a^x)' = a^x·ln(a)",
            "(lnx)' = 1/x",
            "(f+g)' = f' + g'",
            "(fg)' = f'g + fg'",
            "(f/g)' = (f'g − fg')/g²",
            "(f(g(x)))' = f'(g(x))·g'(x)"
        ],
    },

    "проценты": {
        "summary": (
            "Проценты: 1% = 1/100.\n"
            "Типовые задачи:\n"
            "1) Найти p% от числа: умножить на p/100.\n"
            "2) Найти число по его p%: разделить на p/100.\n"
            "3) Изменение на p%: новое = старое·(1 ± p/100).\n"
            "4) Последовательные изменения считаются умножением коэффициентов."
        ),
        "formulas": [
            "p% = p/100",
            "p% от N: N·p/100",
            "Если p% от N равно A: N = A·100/p",
            "Новое после +p%: N_new = N·(1 + p/100)",
            "Новое после −p%: N_new = N·(1 − p/100)"
        ],
    },

    "дроби": {
        "summary": (
            "Дроби: a/b — часть целого.\n"
            "Алгоритм:\n"
            "1) При сложении/вычитании приведи к общему знаменателю.\n"
            "2) При умножении перемножь числители и знаменатели.\n"
            "3) Деление — умножение на обратную дробь.\n"
            "4) Сокращай дробь на общий делитель."
        ),
        "formulas": [
            "a/b + c/d = (ad + bc)/(bd)",
            "a/b − c/d = (ad − bc)/(bd)",
            "(a/b)·(c/d) = (ac)/(bd)",
            "(a/b) : (c/d) = (a/b)·(d/c), c≠0",
            "Смешанное: n a/b = (nb+a)/b"
        ],
    },

    "функции": {
        "summary": (
            "Функция сопоставляет каждому x одно значение y.\n"
            "Что важно:\n"
            "1) Область определения D(f).\n"
            "2) Область значений E(f).\n"
            "3) Нули функции (f(x)=0).\n"
            "4) Монотонность и график.\n"
            "Часто нужно уметь подставлять значения и строить графики основных типов."
        ),
        "formulas": [
            "Линейная: y = kx + b",
            "Квадратичная: y = ax² + bx + c",
            "Показательная: y = a^x (a>0, a≠1)",
            "Логарифмическая: y = log_a(x) (a>0, a≠1, x>0)",
            "Обратная пропорциональность: y = k/x (x≠0)"
        ],
    },

    # Granular Geometry (оставляем, но расширяем формулы/конспект)
    "triangle_area_volume": {
        "summary": (
            "Треугольник: площадь чаще всего ищут по основанию и высоте.\n"
            "Шаги:\n"
            "1) Найди основание a и высоту h_a (или восстанови высоту).\n"
            "2) Используй S = 1/2·a·h_a.\n"
            "Если известны 3 стороны: применяй формулу Герона.\n"
            "Если есть две стороны и угол между ними: S = 1/2·ab·sin(γ)."
        ),
        "formulas": [
            "S = 1/2·a·h_a",
            "Герон: S = √(p(p−a)(p−b)(p−c)), где p=(a+b+c)/2",
            "S = 1/2·ab·sin(γ)",
            "Сумма углов: α+β+γ = 180°"
        ],
    },

    "square_area_volume": {
        "summary": (
            "Квадрат: все стороны равны, углы 90°.\n"
            "Часто ищут площадь или периметр.\n"
            "Шаги:\n"
            "1) Найди сторону a.\n"
            "2) P = 4a, S = a².\n"
            "Если дана диагональ d: a = d/√2."
        ),
        "formulas": [
            "P = 4a",
            "S = a²",
            "d = a√2",
            "a = d/√2"
        ],
    },

    "rectangle_area_volume": {
        "summary": (
            "Прямоугольник: противоположные стороны равны, углы 90°.\n"
            "Частые задачи:\n"
            "• по периметру и отношению сторон найти стороны и площадь.\n"
            "Шаги:\n"
            "1) Если P известен: a+b = P/2.\n"
            "2) Используй условие (например a=3b) и найди a,b.\n"
            "3) Площадь S = ab."
        ),
        "formulas": [
            "P = 2(a+b)",
            "S = a·b",
            "a+b = P/2",
            "d = √(a²+b²)"
        ],
    },

    "circle_area_volume": {
        "summary": (
            "Круг: задачи на площадь и длину окружности.\n"
            "Шаги:\n"
            "1) Найди радиус r (или диаметр d=2r).\n"
            "2) Площадь: S = πr².\n"
            "3) Длина окружности: L = 2πr = πd."
        ),
        "formulas": [
            "S = πr²",
            "L = 2πr",
            "L = πd",
            "d = 2r",
            "π ≈ 3.14"
        ],
    },

    "cube_area_volume": {
        "summary": (
            "Куб: все рёбра равны a.\n"
            "Шаги:\n"
            "1) Объём: V = a³.\n"
            "2) Площадь поверхности: S = 6a².\n"
            "Если дана диагональ куба D: D = a√3."
        ),
        "formulas": [
            "V = a³",
            "S_пов = 6a²",
            "Диагональ грани: d = a√2",
            "Диагональ куба: D = a√3",
            "a = D/√3"
        ],
    },

    "cylinder_area_volume": {
        "summary": (
            "Цилиндр: радиус r и высота h.\n"
            "Шаги:\n"
            "1) Объём: V = πr²h.\n"
            "2) Боковая поверхность: S_бок = 2πrh.\n"
            "3) Полная поверхность: S_полн = 2πr(h+r)."
        ),
        "formulas": [
            "V = πr²h",
            "S_бок = 2πrh",
            "S_полн = 2πr(h+r)",
            "d = 2r"
        ],
    },
}

# Применяем обновления: меняем ТОЛЬКО summary и formulas
for topic, upd in topic_updates.items():
    if topic in topic_blocks:
        topic_blocks[topic]["summary"] = upd["summary"]
        topic_blocks[topic]["formulas"] = upd["formulas"]
    else:
        # если темы нет — добавим минимально (только summary/formulas)
        topic_blocks[topic] = {
            "summary": upd["summary"],
            "formulas": upd["formulas"]
        }

print("✅ summary и formulas обновлены для тем:", list(topic_updates.keys()))
